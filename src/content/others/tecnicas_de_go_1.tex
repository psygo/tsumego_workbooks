
\documentclass[14pt]{book}

% A4
\usepackage[
  paperheight   = 297mm, 
  paperwidth    = 210mm,
  bindingoffset = 10mm,
  left          = 7.5mm,
  right         = 12.5mm,
  top           = 20mm,
  bottom        = 15mm,
  footskip      = 5mm,
]{geometry}

\usepackage[%
  colorlinks  = true,
  allcolors   = black,
  pdfsubject  = {Go;\ Baduk;\ Weiqi},
  pdftitle    = {Técnicas\ de\ Go\ ---\ Volume I (Exercícios)\ ---\ Captura\ e\ Vida\ ou\ Morte},
  pdfauthor   = {Philippe\ Fanaro},
  pdfkeywords = {Go;\ Baduk;\ Weiqi;\ Tsumegos},
  pdfproducer = {LaTeX},
  pdfcreator  = {pdflatex;\ bibtex},
  bookmarksnumbered,
]{hyperref}

\def\repoPath{/Users/phili/Code/Go/tsumego_workbooks/src}
\usepackage{\repoPath/config}

\pgfkeys{%
  /phili/tdgChapterGenerator/.cd, 
    chapter name/.store in = \tdgChapterName,
    chapter name           = Chapter,
    path/.store in         = \tdgChapterPath,
    path                   = sgf,
    max problem/.store in  = \tdgProblemMax,
    max problem            = 1,
}

\newcommand\tdgChapterGenerator[1][]{%
  \pgfkeys{/phili/tdgChapterGenerator/.cd, #1}%
  \chapter{\tdgChapterName}
  \clearpage
  \foreach \i in {1,...,\tdgProblemMax}{
    \problemDiagram[%
      path                      = \tdgChapterPath/\i.sgf,
      problem size              = 8.5,
      problem text              = ,
      caption horizontal margin = -0.4cm,
      horizontal clip start     = 8,
      horizontal clip end       = 19,
      vertical clip start       = 9,
      vertical clip end         = 19,
    ]%
  }\hspace*{-\fill}%
}

\newcommand\coverRuler{
  \rule{0.97\textwidth}{1.6pt}\vspace*{-\baselineskip}\vspace*{2pt}
  \rule{0.97\textwidth}{0.4pt}
}

\newcommand\tdgTitlePage{
  \begin{titlepage}
    \centering
    
    \scshape % Small Caps

    \vspace*{-0.9cm}
    
    %---------------------------------------------------------
    % Título
    
    \coverRuler
    
    \vspace{1\baselineskip}
    
    \fontsize{50pt}{50pt}\selectfont{Técnicas de Go} \\
    \vspace*{0.8cm}
    \fontsize{40pt}{40pt}\selectfont{Volume \rom{1} | Exercícios} \\
    \vspace*{0.9cm}
    \fontsize{35pt}{35pt}\selectfont{Liberdades e Vida ou Morte} \\

    \vspace{0.275\baselineskip}
    
    \coverRuler

    %---------------------------------------------------------

    \vspace*{-0.42cm}

    %---------------------------------------------------------
    % Imagem
    
    \begin{figure}[h]
      \centering
      \hbox{
        % Inside the book, this changes due to the margins
        \hspace{1.95cm}
        \begin{goban}[board dimension       = 12,
                      board size            = 9,
                      scale                 = 1,
                      outline line width    = 0.45mm,
                      horizontal clip start = 1,
                      horizontal clip end   = 9,
                      vertical clip start   = 1,
                      vertical clip end     = 9]
          \parseSgfFile{\repoPath/sgf/tecnicas_de_go/capa_9x9_atravessar.sgf}
        \end{goban}
      }
    \end{figure}

    %---------------------------------------------------------
    
    \vspace*{-0.1cm}

    %---------------------------------------------------------
    % Autor

    \fontsize{35pt}{35pt}\selectfont{Philippe Fanaro} \\

    %---------------------------------------------------------
  \end{titlepage}
}

\begin{document}
  \blankpage
  \tdgTitlePage
  \blankpage
  
  \frontmatter

  \tableofcontents

  \mainmatter

  %---------------------------------------------------------
  % Liberdades
  
  \part{Liberdades}

  \tdgChapterGenerator[%
    chapter name = Captura Direta,
    path         = {\repoPath/sgf/tecnicas_de_go/liberdades/captura},
    max problem  = 10,
  ]

  \tdgChapterGenerator[%
    chapter name = Resgate,
    path         = {\repoPath/sgf/tecnicas_de_go/liberdades/resgate},
    max problem  = 10,
  ]

  \tdgChapterGenerator[%
    chapter name = Duplo-Atari,
    path         = {\repoPath/sgf/tecnicas_de_go/liberdades/duplo_atari},
    max problem  = 5,
  ]

  \tdgChapterGenerator[%
    chapter name = Suicídio,
    path         = {\repoPath/sgf/tecnicas_de_go/liberdades/suicidio},
    max problem  = 5,
  ]

  \tdgChapterGenerator[%
    chapter name = Recaptura,
    path         = {\repoPath/sgf/tecnicas_de_go/liberdades/recaptura},
    max problem  = 5,
  ]

  \tdgChapterGenerator[%
    chapter name = Ko,
    path         = {\repoPath/sgf/tecnicas_de_go/liberdades/ko},
    max problem  = 10,
  ]

  \tdgChapterGenerator[%
    chapter name = Captura na Segunda Linha,
    path         = {\repoPath/sgf/tecnicas_de_go/liberdades/captura_na_segunda_linha},
    max problem  = 5,
  ]

  \tdgChapterGenerator[%
    chapter name = Conectar e Morrer,
    path         = {\repoPath/sgf/tecnicas_de_go/liberdades/conectar_e_morrer},
    max problem  = 5,
  ]

  \tdgChapterGenerator[%
    chapter name = Escadas,
    path         = {\repoPath/sgf/tecnicas_de_go/liberdades/escadas},
    max problem  = 10,
  ]

  \tdgChapterGenerator[%
    chapter name = Redes,
    path         = {\repoPath/sgf/tecnicas_de_go/liberdades/redes},
    max problem  = 20,
  ]

  \tdgChapterGenerator[%
    chapter name = Ricochete,
    path         = {\repoPath/sgf/tecnicas_de_go/liberdades/sacrificio},
    max problem  = 10,
  ]

  \tdgChapterGenerator[%
    chapter name = Espremer,
    path         = {\repoPath/sgf/tecnicas_de_go/liberdades/espremer},
    max problem  = 15,
  ]

  \tdgChapterGenerator[%
    chapter name = Cortes,
    path         = {\repoPath/sgf/tecnicas_de_go/liberdades/cortes},
    max problem  = 10,
  ]

  \tdgChapterGenerator[%
    chapter name = Atravessar,
    path         = {\repoPath/sgf/tecnicas_de_go/liberdades/atravessar},
    max problem  = 10,
  ]

  \tdgChapterGenerator[%
    chapter name = Corridas de Captura,
    path         = {\repoPath/sgf/tecnicas_de_go/liberdades/corridas_de_captura},
    max problem  = 15,
  ]

  %---------------------------------------------------------
  % Vida ou Morte
  
  \part{Vida ou Morte}

  \tdgChapterGenerator[%
    chapter name = Dois Olhos,
    path         = {\repoPath/sgf/tecnicas_de_go/vida_ou_morte/dois_olhos},
    max problem  = 10,
  ]

  \tdgChapterGenerator[%
    chapter name = Olhos Falsos,
    path         = {\repoPath/sgf/tecnicas_de_go/vida_ou_morte/olhos_falsos},
    max problem  = 10,
  ]

  \tdgChapterGenerator[%
    chapter name = Formas Mortas,
    path         = {\repoPath/sgf/tecnicas_de_go/vida_ou_morte/formas_mortas},
    max problem  = 20,
  ]

  \tdgChapterGenerator[%
    chapter name = Vida na Segunda Linha,
    path         = {\repoPath/sgf/tecnicas_de_go/vida_ou_morte/vida_segunda_linha},
    max problem  = 5,
  ]

  \tdgChapterGenerator[%
    chapter name = Vida Mútua,
    path         = {\repoPath/sgf/tecnicas_de_go/vida_ou_morte/vida_mutua},
    max problem  = 10,
  ]

  %---------------------------------------------------------
  
  \blankpage
  \blankpage
\end{document}